name: "MAStAC_4v4_9"
seed: 42

device:
  use_cuda: True
  cuda_device: 0

# ==========================
# ENVIRONMENT
# ==========================
env:
  name: MATE
  config_file: mate/assets/MATE-4v4-9.yaml
  render_mode: "rgb_array"    # Use rgb_array for training (human mode is too slow!)
  window_size: 800
  max_episode_steps: 2000
  reward_type: dense
  target_controller: greedy   # OR "random" if bạn muốn đa dạng hành vi target

# ==========================
# GRAPH SETTINGS (MAStAC core)
# ==========================
graphs:
  ES: []          # structure coupling (thường không dùng MATE)
  EO: []          # observation coupling
  ER: []          # reward coupling
  kappa: 2        # LIMIT độ sâu phụ thuộc (paper: kappa ≤ 3)

# ==========================
# MODEL SETTINGS (MAStAC)
# ==========================
model:
  actor_hidden: [256, 256]
  critic_gnn_hidden: [256, 256]
  critic_mlp_hidden: [256, 128]
  lr_actor: 0.0001
  lr_critic: 0.001
  gamma: 0.95
  tau: 0.01            # target soft update
  exploration_noise: 0.1

# ==========================
# TRAINING
# ==========================
training:
  total_timesteps: 40000
  learning_starts: 1000        # Reduced for faster training start
  train_freq: 1                # Train every step after learning_starts
  gradient_steps: 1             # Number of gradient steps per update
  batch_size: 128
  buffer_size: 40000

# ==========================
# LOGGING
# ==========================
logging:
  log_interval: 1000           # Log every 1000 steps for progress tracking
  eval_interval: 1000         # Evaluate every 10k steps
  save_interval: 10000         # Save every 50k steps
  log_dir: logs/mastac
  model_dir: models/mastac

# ==========================
# EVALUATION
# ==========================
evaluation:
  n_eval_episodes: 8
  eval_deterministic: true
  render_eval: false
  save_videos: false
  video_dir: videos

# ==========================
# VIDEO
# ==========================
video:
  enabled: false
  fps: 30
  record_every: 15000
  max_frames: 2000
